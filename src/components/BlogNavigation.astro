---
import type { CollectionEntry } from 'astro:content'

type Props = {
  currentSlug: string
  posts: CollectionEntry<'blog'>[]
  lang: string
}

const { currentSlug, posts, lang } = Astro.props

const index = posts.findIndex(p => {
  const slug = p.data.slug || p.id.split('/').pop()?.replace(/\.mdx?$/, '')
  return slug === currentSlug
})

const prev = posts[index - 1]
const next = posts[index + 1]

const getUrl = (post: CollectionEntry<'blog'>) => {
  const slug = post.data.slug || post.id.split('/').pop()?.replace(/\.mdx?$/, '')
  return `/${lang}/blog/${slug}`
}
---

<div class='flex max-sm:flex-col sm:justify-between gap-2 mt-3 sm:mt-6'>
  {prev && (
    <a href={getUrl(prev)} class='group inline-flex items-center gap-x-2 rounded-xl px-4 py-2 hover:bg-muted'>
      <svg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke-width='2.5' class='shrink-0 rotate-180 stroke-muted-foreground group-hover:stroke-primary'>
        <polyline points='12 5 19 12 12 19' />
      </svg>
      <p class='truncate font-medium'>{prev.data.title}</p>
    </a>
  )}
  {next && (
    <a href={getUrl(next)} class='group inline-flex items-center gap-x-2 rounded-xl px-4 py-2 hover:bg-muted ml-auto'>
      <p class='truncate font-medium'>{next.data.title}</p>
      <svg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke-width='2.5' class='shrink-0 stroke-muted-foreground group-hover:stroke-primary'>
        <polyline points='12 5 19 12 12 19' />
      </svg>
    </a>
  )}
</div>
